FROM ghcr.io/digiimmi/php-7.4-cli:latest

RUN apt-get update \
&& apt-get upgrade -y \
&& apt-get install -y libzip-dev libpng-dev libevent-dev libssl-dev git wget curl nload \
&& docker-php-ext-install zip mysqli bcmath gd pcntl pdo_mysql sockets \
&& pecl install event redis \
&& docker-php-ext-enable event redis \
&& php -m \
&& php -r "copy('https://install.phpcomposer.com/installer', 'composer-setup.php');" \
&& php composer-setup.php \
&& php -r "unlink('composer-setup.php');" \
&& mkdir -p /usr/src/APP
&& mkdir -p /tmp/logs \
&& mkdir -p /tmp/sessions \
&& mkdir -p /tmp/views \
&& rm -rf /app/runtime \
&& ln -s /tmp  /app/runtime \
&& ln -s /app/composer.phar /usr/bin/composer \
WORKDIR /app
